#!/bin/bash
set -e

# Reasoning behind this extension can be found here: https://blog.jongallant.com/2021/06/codespaces-gh-cli-git-credentials/

# First clear the GITHUB_TOKEN so gh auth login works
export GITHUB_TOKEN=

# Second login to gh cli
gh auth login

# Third configure gh auth git-credential
git config --global 'credential.https://github.com.helper' ''
git config --global --add 'credential.https://github.com.helper' '!gh auth git-credential'

echo "Successfully added 'gh auth git-credential' as your git credential helper."
